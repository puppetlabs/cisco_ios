---
default:
  tests:
    "snmp user create v1":
      version: 'v1'
      device_output: "snmp-server user alpha public v1\n"
      commands:
      - "snmp-server user alpha public v1"
      get_expectations:
      - :name: 'alpha v1'
        :ensure: :present
        :version: 'v1'
        :roles: 'public'
      set_expectations:
      - :name: 'alpha v1'
        :ensure: :present
        :version: 'v1'
        :roles: 'public'
    "snmp user create v3":
      version: 'v3'
      device_output: "\nUser name: charlie\nEngine ID: 800000090300001EBE6E712C\nstorage-type: nonvolatile	 active\nAuthentication Protocol: MD5\nPrivacy Protocol: AES192\nGroup-name: public\n\n"
      commands:
      - "snmp-server user charlie public v3 encrypted auth md5 b7:d1:92:a4:4e:0d:a1:6c:d1:80:eb:e8:5e:fb:7c:8f priv aes 192 b7:d1:92:a4:4e:0d:a1:6c:d1:80:eb:e8:5e:fb:7c:8f"
      get_expectations:
      - :name: 'charlie v3'
        :ensure: :present
        :version: 'v3'
        :enforce_privacy: 'true'
        :roles: 'public'
        :auth: 'md5'
        :password: 'b7:d1:92:a4:4e:0d:a1:6c:d1:80:eb:e8:5e:fb:7c:8f'
        :privacy: 'aes 192'
        :private_key: 'b7:d1:92:a4:4e:0d:a1:6c:d1:80:eb:e8:5e:fb:7c:8f'
        :engine_id: '800000090300001EBE6E712C'
      set_expectations:
      - :name: 'charlie v3'
        :ensure: :present
        :version: 'v3'
        :roles: 'public'
        :auth: 'md5'
        :privacy: 'AES192'
        :engine_id: '800000090300001EBE6E712C'
